<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Офисы Домиан</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f9f9f9;
    }
    h1, h2 {
      color: #333;
    }
    input#search {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      box-sizing: border-box;
      font-size: 16px;
    }
    .section {
      margin-bottom: 40px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    th {
      background-color: #eee;
    }
    tr.inactive {
      background-color: #ffecec;
    }
    tr.orlov {
      background-color: #ecf9ff;
    }
    tr:hover {
      background-color: #f5f5f5;
      cursor: pointer;
    }
    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .badge {
      background-color: #f0f0f0;
      border-radius: 12px;
      padding: 2px 8px;
      font-size: 0.8em;
    }

    /* Стили для модального окна */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
    }
    .modal-content {
      position: relative;
      margin: 5% auto;
      padding: 20px;
      width: 90%;
      max-width: 800px;
      background: white;
      border-radius: 8px;
      max-height: 90vh;
      overflow-y: auto;
    }
    .close {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      color: #333;
    }
    .office-photos {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .office-photo {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .office-photo:hover {
      transform: scale(1.05);
    }
    .office-info {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    .no-photos {
      text-align: center;
      color: #666;
      font-style: italic;
      padding: 40px;
    }

    /* Модальное окно для полноразмерного изображения */
    .photo-modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
    }
    .photo-modal-content {
      display: block;
      margin: auto;
      max-width: 90%;
      max-height: 90%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    .photo-close {
      position: absolute;
      right: 25px;
      top: 15px;
      color: white;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>Список офисов Домиан</h1>
  <input type="text" id="search" placeholder="Поиск по ключевым словам (название, адрес, ИНН, телефон и т.д.)" />

  <div class="section">
    <h2 class="section-title">
      Активные офисы
      <span class="badge" id="active-count"></span>
    </h2>
    <table id="active-table">
      <thead>
        <tr>
          <th>№</th>
          <th>Название офиса</th>
          <th>Адрес</th>
          <th>Телефон</th>
          <th>Собственник</th>
          <th>ИНН</th>
          <th>Почта</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="section">
    <h2 class="section-title">
      Офисы Павла Орлова
      <span class="badge" id="orlov-count"></span>
    </h2>
    <table id="orlov-table">
      <thead>
        <tr>
          <th>№</th>
          <th>Название офиса</th>
          <th>Адрес</th>
          <th>Телефон</th>
          <th>Собственник</th>
          <th>ИНН</th>
          <th>Почта</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="section">
    <h2 class="section-title">
      Неактивные (удалённые) офисы
      <span class="badge" id="inactive-count"></span>
    </h2>
    <table id="inactive-table">
      <thead>
        <tr>
          <th>№</th>
          <th>Название офиса</th>
          <th>Адрес</th>
          <th>Телефон</th>
          <th>Собственник</th>
          <th>ИНН</th>
          <th>Почта</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Модальное окно с фотографиями офиса -->
  <div id="officeModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="officeInfo" class="office-info"></div>
      <div id="officePhotos" class="office-photos"></div>
    </div>
  </div>

  <!-- Модальное окно для полноразмерного фото -->
  <div id="photoModal" class="photo-modal">
    <span class="photo-close">&times;</span>
    <img class="photo-modal-content" id="fullSizePhoto">
  </div>

  <script>
    // Полные данные из Лист1
    const offices = [
      { id: 1, name: "Квартал", address: "Г. Аксай Ул. Толпинского 130, офис 4", phone: "89536091122", owner: "Алиева Зухра", inn: "662104294378", email: "zuhra_2010_aidan@mail.ru" },
{ id: 2, name: "Домиан Добровольского", address: "Ростов-на-Дону, Добровольского 13", phone: "89094101040", owner: "Баев Денис", inn: "616613990495", email: "Bdvrostov@mail.ru" },
      { id: 3, name: "Домиан-Шолохова", address: "Ростов-на-Дону, 14 линия 84 «б»", phone: "89034032306", owner: "Баранова Ольга", inn: "616710699958", email: "monaxv@mail.ru" },
      { id: 4, name: "Домиан Эстет", address: "344090 г. Ростов-на-Дону, ул Толмачева 50", phone: "89286191000", owner: "Бордиенко Роман", inn: "612704481466", email: "Rbordienko@mail.ru" },
      { id: 5, name: "Батайск 2", address: "г. Батайск , ул. Куйбышева 127", phone: "89281336432", owner: "Брагин Андрей", inn: "614102148704", email: "b2domian@mail.ru" },
      { id: 6, name: "Домиан «Семейный»", address: "Батайск, заводская 184 оф 22", phone: "89885397342", owner: "Брыкалина Лилия", inn: "615101072300", email: "karmazina-lilya@mail.ru" },
      { id: 7, name: "Шахты на Маяковского", address: "г. Шахты, ул. Маяковского 18А", phone: "89185071000", owner: "Воронина Мария", inn: "262810552536", email: "Babushkina_Mariya.10@mail.ru" },
      { id: 8, name: "Домиан Коммерция", address: "ул. Береговая 6 (тц Белый Ангел)", phone: "89282294777", owner: "Галкин Алексей / Шаповалов Виктор", inn: "614105200744", email: "Domian.com@yandex.ru" },
      { id: 9, name: "Гвардейский", address: "Ростов-на-Дону, Буденновский , 59", phone: "89286119411", owner: "Грибенюк Светлана", inn: "615416655175", email: "bezglasnaya-19@yandex.ru" },
      { id: 10, name: "Аксай Центральный", address: "Аксай, заводская 22", phone: "89525888367", owner: "Гуков Денис", inn: "616111710000", email: "" },
      { id: 11, name: "Нариманова", address: "Ростов-на-Дону, нагибина 40Б, оф.308", phone: "89525888367", owner: "Гуков Денис", inn: "616111710000", email: "" },
      { id: 12, name: "Домиан офис Даниловых", address: "Ростов-на-Дону, Сальский 101, офис 121", phone: "89889908913", owner: "Данилова Ольга Георгиевна", inn: "614603129156", email: "Olgageorgievna87@yandex.ru" },
      { id: 13, name: "Домиан Мой Дом", address: "40 летия победы 63 /17с8", phone: "89281779893", owner: "Дронова Алена", inn: "614702345824", email: "lena.dronova.1974@mail.ru" },
      { id: 14, name: "Домиан Уютный Дом", address: "Ростов-на-Дону, Мечникова 114/134 оф 210", phone: "89094324999", owner: "Дудка Павел", inn: "611301324959", email: "domian.na.dony@gmail.com" },
      { id: 15, name: "Батайск Южный", address: "Батайск Почтовая 202-204", phone: "89085137842", owner: "Ефремова Наталья", inn: "614901636754", email: "Vampiressa83@mail.ru" },
      { id: 16, name: "Домиан Малиновского", address: "Ростов-на-Дону, ул. Малиновского, 46а/27 оф. 24", phone: "918 574-35-20", owner: "Заичкин Иван", inn: "611804206430", email: "zaichkin.ivan1501@yandex.ru" },
      { id: 17, name: "ВектоР Домиан", address: "Ростов-на-Дону, зорге, 17 оф 2", phone: "89613165717", owner: "Залещенко Анна", inn: "612701340763", email: "anna.zaleshenko@yandex.ru" },
      { id: 18, name: "Новочеркасск 2", address: "Новочеркасск, Народная 1 оф 114", phone: "89381545915", owner: "Зеленьков Александр", inn: "61490663404", email: "an_domian@mail.ru" },
      { id: 19, name: "Домиан Сельмаш", address: "Ростов-на-Дону, 1-й конной армии 13в офис 22", phone: "89381545915", owner: "Зеленьков Александр", inn: "61490663404", email: "an_domian@mail.ru" },
      { id: 20, name: "Домиан Северный-3", address: "344092 г.Ростов-на-Дону, пр.Космонавтов 31В/21В, 3 этаж,офис 30.", phone: "89282291244", owner: "Кивва Ирина", inn: "615000646692", email: "rostovatlasan@yandex.ru" },
      { id: 21, name: "Суворовский 2", address: "Ростов-на-Дону, Петренко 18", phone: "89889961300", owner: "Князев Павел", inn: "612400841004", email: "Knyazevp83@mail.ru" },
      { id: 22, name: "ЛеМар Вересаево", address: "Ростов-на-Дону, ул. Берберовская, 2/101, стр 2 оф. 12", phone: "89885715714", owner: "Козлова Елена", inn: "616610539710", email: "elena.kozlovva@yandex.ru" },
      { id: 23, name: "Домиан Эксперт", address: "Ростов-на-Дону, ул. Б. Садовая, 162/70, кв 7", phone: "89185587898", owner: "Котовская Ольга", inn: "616603300375", email: "domianexpert@mail.ru" },
      { id: 24, name: "Домиан Рантье", address: "Ростов-на-Дону, ул. Красноармейская, 121", phone: "905 455-96-56", owner: "Кравцов Андрей", inn: "615490300115", email: "domianandrey@yandex.ru" },
      { id: 25, name: "Новочеркасск 1", address: "Новочеркасск, пр-т Платовский, 92", phone: "89034633125", owner: "Лебедев Никита", inn: "615015517925", email: "domiannovoch@gmail.com" },
      { id: 26, name: "Севастополь", address: "Севастополь, ул. Астана Кесаева, д. 3б, 4 этаж, офис 25", phone: "89034633125", owner: "Лебедев Никита", inn: "615015517925", email: "domiannovoch@gmail.com" },
      { id: 27, name: "Западный Алмаз", address: "Ростов-на-Дону, Стачки 188", phone: "89287544147", owner: "Лобань Илона", inn: "263013312006", email: "Ilona.loban75@mail.ru" },
      { id: 28, name: "Домиан Нагибина", address: "Ростов-на-Дону, Нагибина 23", phone: "89034015545", owner: "Марков Алексей", inn: "616107282175", email: "2215545@bk.ru" },
      { id: 29, name: "Аксай", address: "Аксай, Ленина, 41", phone: "89381479660", owner: "Межов Александр", inn: "613203719423", email: "m89381479660@yandex.ru" },
      { id: 30, name: "Домиан ЛегеАртис", address: "пос. верхнетемерницкий, ул. обсерваторная, 104/1, оф. 15", phone: "89381479660", owner: "Межов Александр", inn: "613203719423", email: "m89381479660@yandex.ru" },
      { id: 31, name: "Ленинаван", address: "Ростов-на-Дону, шаумяна, 1е", phone: "89381479660", owner: "Межов Александр", inn: "613203719423", email: "m89381479660@yandex.ru" },
      { id: 32, name: "Янтарный", address: "Камышеваха, платиновая 10/26", phone: "89381479660", owner: "Межов Александр", inn: "613203719423", email: "m89381479660@yandex.ru" },
      { id: 33, name: "Домиан Риелт", address: "Туполева 16е офис 523", phone: "928 197-03-77", owner: "Молчанов Андрей", inn: "616602237568", email: "" },
      { id: 34, name: "Левенцовский 1", address: "Ростов-на-Дону, ерёменко 99", phone: "89515269848", owner: "Москвина Наталья", inn: "", email: "" },
      { id: 35, name: "Домиан Верхняя Александровка", address: "Ростов-на-Дону, 40 лет победы 156/7", phone: "89996914634", owner: "Некрасова Юлия", inn: "616511782591", email: "d9996914634@gmail.com" },
      { id: 36, name: "Золотой квадрат", address: "Ростов-на-Дону, малиновского 66/1", phone: "89054274347", owner: "Немченко Вадим", inn: "616802670941", email: "" },
      { id: 37, name: "Азов Первый", address: "г. Азов, Петровский бульвар, 20/27", phone: "89054274347", owner: "Немченко Вадим", inn: "616802670941", email: "" },
      { id: 38, name: "Капитал", address: "Ростов-на-Дону Подвойского 58 / 85", phone: "89885569888", owner: "Обдул Алла", inn: "526104307869", email: "" },
      { id: 39, name: "Западный 2", address: "Ростов-на-Дону, Зорге, 64б", phone: "89612969000", owner: "Панасенко Артем", inn: "614807776440", email: "" },
      { id: 40, name: "Домиан Премьер", address: "Ростов-на-Дону, ул. М. Горького, 120, оф. 22", phone: "89612969000", owner: "Панасенко Артем", inn: "614807776440", email: "" },
      { id: 41, name: "Батайск 1", address: "Батайск, энгельса 188", phone: "89185325887", owner: "Панасенко/Курмак Марина", inn: "614807776440", email: "" },
      { id: 42, name: "Династия", address: "", phone: "89185543889", owner: "Пирогова Екатерина", inn: "616704685562", email: "Katrine.pirogova@yandex.ru" },
      { id: 43, name: "Домиан Лермонт", address: "Ростов на Дону, ул. Лермонтовская, 102", phone: "89139835313", owner: "Рубежанская Кристина", inn: "", email: "" },
      { id: 44, name: "Новочеркасск Октябрьский", address: "Новочеркасск, калинина 65б", phone: "89515195559", owner: "Сафронов Андрей", inn: "615015517925", email: "domiannovoch@gmail.com" },
      { id: 45, name: "Первомайский", address: "Ростов-на-Дону, Лелюшенко 1", phone: "89085065451", owner: "Скворцова Елена", inn: "612401877081", email: "komaroffilia@yandex.ru" },
      { id: 46, name: "Меркурий", address: "Ростов-на-Дону, Коммунистический 25", phone: "89282708098", owner: "Скрыпникова Наталья", inn: "90103100798", email: "NATA2708098@MAIL.RU" },
      { id: 47, name: "Офис на Пушкинской", address: "Ростов-на-Дону, пушкинская 206", phone: "89515163816", owner: "Смехнова Оксана", inn: "616715303416", email: "domian.ug@yandex.ru" },
      { id: 48, name: "Домиан Свердловск ЛНР", address: "временно без офиса", phone: "89595213070", owner: "Теплинский Сергей", inn: "", email: "" },
      { id: 49, name: "Домиан Волгодонск Первый", address: "Волгодонск, Энтузиастов 26б", phone: "89054287650", owner: "Тёркин Валерий", inn: "614301274189", email: "domian.irina.1989@mail.ru" },
      { id: 50, name: "Западный Олимп", address: "Ростов-на-Дону, ул. Зорге 11", phone: "89054287650", owner: "Тёркин Валерий", inn: "614301274189", email: "domian.irina.1989@mail.ru" },
      { id: 51, name: "Домиан Белая Калитва", address: "г. Белая Калитва, ул. Калинина, 2", phone: "89895150006", owner: "Титовский Роман", inn: "614211438308", email: "domian.bk@mail.ru" },
      { id: 52, name: "Домиан Каменск-Шахтинский", address: "Каменск-Шахтинский, ул. Ворошилова 13", phone: "89005550006", owner: "Титовский Роман", inn: "614211438308", email: "domian.bk@mail.ru" },
      { id: 53, name: "Домиан Миллерово", address: "Миллерово, Ул. Российская 59", phone: "89895250006", owner: "Титовский Роман", inn: "614211438308", email: "domian.bk@mail.ru" },
      { id: 54, name: "Шахты Результат+", address: "г. Шахты, Шевченко 125А", phone: "89895150006", owner: "Титовский Роман", inn: "614211438308", email: "domian.bk@mail.ru" },
      { id: 55, name: "Домиан Стачки", address: "Ростов-на-Дону, стачки 210", phone: "89034020438", owner: "Уваров Сергей", inn: "616612442811", email: "s.n.uwarow@mail.ru" },
      { id: 56, name: "Домиан Первые Соловушки", address: "Ростов-на-Дону, вятская 57", phone: "89185587372", owner: "Червоный Валерий", inn: "220909657200", email: "elena.chervonaja@bk.ru" },
      { id: 57, name: "Домиан Миллениум", address: "Ростов-на-Дону, ул. Семашко, 114 оф. 208", phone: "89081715032", owner: "Черевченко Кирилл", inn: "", email: "" },
      { id: 58, name: "Домиан Кристалл", address: "Ростов-на-Дону, Жк Екатерининский, Магнитогорская 1а", phone: "89281386630", owner: "Чумакова Лариса", inn: "615511722600", email: "domian_kristall@mai.ru" },
      { id: 59, name: "Западный 5", address: "Ростов-на-Дону, Зорге 56", phone: "89287755443", owner: "Чуносов Михаил", inn: "616117980098", email: "mike.rostov@mail.ru" },
      { id: 60, name: "Горизонт", address: "Ростов-на-Дону, Ларина 45 ст 2", phone: "89508681000", owner: "Чуприна Екатерина", inn: "616113019969", email: "domain.gorizont@ya.ru" },
      { id: 61, name: "Домиан Таганрог", address: "г. Таганрог, ул. Социалистическая, 2, оф 310", phone: "89381433301", owner: "Шаповалов Сергей", inn: "615424204391", email: "" },
      { id: 62, name: "Западный 11", address: "Ростов-на-Дону, малиновского 3 «б», оф.25, 2эт", phone: "89885801473", owner: "Шиянова Елена", inn: "", email: "" },
      { id: 63, name: "Полёт", address: "Берберовская 24", phone: "89185215152", owner: "Юдин Александр", inn: "", email: "" },
      { id: 64, name: "Восточный", address: "Ростов-на-Дону,40лет пр. Победы 216 оф5", phone: "89081804213", owner: "Яцык Екатерина", inn: "616710033607", email: "Strochka_rnd@mail.ru" },
      { id: 65, name: "Аллея Домиан", address: "Ростов-на-Дону, Маршала Жукова 16/6", phone: "952 607-92-22", owner: "Лизунова Татьяна Сергеевна", inn: "232704657746", email: "" },
      { id: 66, name: "Домиан Кореновск", address: "Г. Кореновск, ул. Красная, 23", phone: "918 364-45-00", owner: "ГЛОБА ОКСАНА НИКОЛАЕВНА", inn: "233504793704", email: "" },
      { id: 67, name: "Домиан Феникс", address: "Ростов-на-Дону, Троллейбусная 24/2В 6 эт. 617 каб.", phone: "988 990-89-13", owner: "Данилов Сергей Константинович", inn: "325619600101034", email: "" },
      { id: 68, name: "Комфорт", address: "Ростов-на-Дону, Извилистая 17а/Извилистая 17а", phone: "8961 321-90-69", owner: "ДИОНИСОВ ЕВГЕНИЙ АЛЕКСАНДРОВИЧ", inn: "616803377142", email: "dionisoffrealty@yandex.ru" },
      { id: 69, name: "Лайф", address: "Ростов-на-Дону, Армянская 10", phone: "8909 404-34-17", owner: "Геворкян Овсеп Мкртичович", inn: "", email: "" }
    ];

    // Добавляем офисы Павла Орлова
    const orlovOffices = [
      { id: 70, name: "Красный Верес", address: "Вересаева 101/3 ст.2", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
     { id: 71, name: "Центр 1", address: "Красноармейская 121, 2 этаж", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 72, name: "Южный", address: "", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 73, name: "Северный 1", address: "пр-кт Космонавтов 32в, 3 этаж", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 74, name: "Октябрьский", address: "ул. Ленина 46", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 75, name: "Левенцовский 2", address: "ул. Еременко 100/70", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 76, name: "Западный 1", address: "Коммунистический 25", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 77, name: "Краснодар 1", address: "плановый проезд дом 5", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" },
      { id: 78, name: "Сальск-Пушкинский", address: "Пушкина 32", phone: "", owner: "ИП Орлов Павел Викторович", inn: "", email: "" }
    ];

    // Добавляем офисы Павла Орлова в общий список
    offices.push(...orlovOffices);

    // Неактивные офисы по вашему списку
    const inactiveIds = [4, 13, 36, 42, 45, 57];
    
    // Определяем офисы Павла Орлова (включая уже существующие)
    const orlovOfficeIds = [34, 62, 70, 71, 72, 73, 74, 75, 76, 77, 78];

    // БАЗА ДАННЫХ ФОТОГРАФИЙ
    // В реальном приложении эти данные могут приходить с сервера
    const officePhotos = {
      1: [
        "https://via.placeholder.com/400x300/4CAF50/white?text=Офис+Квартал+1",
        "https://via.placeholder.com/400x300/2196F3/white?text=Офис+Квартал+2"
      ],
      2: [
        "https://via.placeholder.com/400x300/FF9800/white?text=Офис+Добровольского+1",
        "https://via.placeholder.com/400x300/9C27B0/white?text=Офис+Добровольского+2"
      ],
      3: [
        "https://via.placeholder.com/400x300/795548/white?text=Офис+Шолохова"
      ],
      // Добавьте фотографии для других офисов по аналогии
      70: [
        "https://via.placeholder.com/400x300/E91E63/white?text=Красный+Верес+1",
        "https://via.placeholder.com/400x300/00BCD4/white?text=Красный+Верес+2",
        "https://via.placeholder.com/400x300/8BC34A/white?text=Красный+Верес+3"
      ]
    };

    // Фильтруем офисы по категориям
    const activeOffices = offices.filter(o => !inactiveIds.includes(o.id) && !orlovOfficeIds.includes(o.id));
    const inactiveOffices = offices.filter(o => inactiveIds.includes(o.id));
    const filteredOrlovOffices = offices.filter(o => orlovOfficeIds.includes(o.id));

    function renderTable(data, tableBodyId, isInactive = false, isOrlov = false) {
      const tbody = document.getElementById(tableBodyId).querySelector('tbody');
      tbody.innerHTML = '';
      data.forEach(item => {
        const row = tbody.insertRow();
        if (isInactive) row.classList.add('inactive');
        if (isOrlov) row.classList.add('orlov');
        
        // Добавляем data-id для идентификации офиса
        row.setAttribute('data-office-id', item.id);
        
        row.innerHTML = `
          <td>${item.id}</td>
          <td>${item.name || '—'}</td>
          <td>${item.address || '—'}</td>
          <td>${item.phone || '—'}</td>
          <td>${item.owner || '—'}</td>
          <td>${item.inn || '—'}</td>
          <td>${item.email || '—'}</td>
        `;
        row.dataset.search = `${item.id} ${item.name} ${item.address} ${item.phone} ${item.owner} ${item.inn} ${item.email}`.toLowerCase();
      });
      
      // Обновляем счетчик
      const countElement = document.getElementById(tableBodyId.replace('table', 'count'));
      if (countElement) {
        countElement.textContent = data.length;
      }
    }

    // Рендерим все три таблицы
    renderTable(activeOffices, 'active-table', false);
    renderTable(filteredOrlovOffices, 'orlov-table', false, true);
    renderTable(inactiveOffices, 'inactive-table', true);

    // Модальные окна
    const officeModal = document.getElementById('officeModal');
    const photoModal = document.getElementById('photoModal');
    const closeBtn = document.querySelector('.close');
    const photoCloseBtn = document.querySelector('.photo-close');

    // Функция для открытия модального окна с фотографиями офиса
    function openOfficeModal(officeId) {
      const office = offices.find(o => o.id === officeId);
      if (!office) return;

      // Заполняем информацию об офисе
      document.getElementById('officeInfo').innerHTML = `
        <h3>${office.name}</h3>
        <p><strong>Адрес:</strong> ${office.address || '—'}</p>
        <p><strong>Телефон:</strong> ${office.phone || '—'}</p>
        <p><strong>Собственник:</strong> ${office.owner || '—'}</p>
        <p><strong>ИНН:</strong> ${office.inn || '—'}</p>
        <p><strong>Почта:</strong> ${office.email || '—'}</p>
      `;

      // Заполняем фотографии
      const photosContainer = document.getElementById('officePhotos');
      const photos = officePhotos[officeId];

      if (photos && photos.length > 0) {
        photosContainer.innerHTML = '';
        photos.forEach((photoUrl, index) => {
          const img = document.createElement('img');
          img.src = photoUrl;
          img.alt = `Фото офиса ${office.name} ${index + 1}`;
          img.className = 'office-photo';
          img.addEventListener('click', () => openPhotoModal(photoUrl));
          photosContainer.appendChild(img);
        });
      } else {
        photosContainer.innerHTML = '<div class="no-photos">Фотографии для этого офиса пока не добавлены</div>';
      }

      officeModal.style.display = 'block';
    }

    // Функция для открытия модального окна с полноразмерным фото
    function openPhotoModal(photoUrl) {
      document.getElementById('fullSizePhoto').src = photoUrl;
      photoModal.style.display = 'block';
    }

    // Закрытие модальных окон
    closeBtn.addEventListener('click', () => {
      officeModal.style.display = 'none';
    });

    photoCloseBtn.addEventListener('click', () => {
      photoModal.style.display = 'none';
    });

    // Закрытие при клике вне модального окна
    window.addEventListener('click', (event) => {
      if (event.target === officeModal) {
        officeModal.style.display = 'none';
      }
      if (event.target === photoModal) {
        photoModal.style.display = 'none';
      }
    });

    // Добавляем обработчики клика на строки таблицы
    document.querySelectorAll('tbody tr').forEach(row => {
      row.addEventListener('click', (event) => {
        // Проверяем, что клик был не на ссылке или другом интерактивном элементе
        if (event.target.tagName !== 'A') {
          const officeId = parseInt(row.getAttribute('data-office-id'));
          openOfficeModal(officeId);
        }
      });
    });

    // Поиск
    document.getElementById('search').addEventListener('input', function () {
      const query = this.value.toLowerCase();
      document.querySelectorAll('tbody tr').forEach(row => {
        const text = row.dataset.search;
        row.style.display = text.includes(query) ? '' : 'none';
      });
    });
  </script>

</body>
</html>
